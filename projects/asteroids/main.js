!function(t){var s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={i:e,l:!1,exports:{}};return t[e].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=s,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var h in t)i.d(e,h,function(s){return t[s]}.bind(null,h));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="",i(i.s=0)}([function(t,s,i){"use strict";function e(t,s,i){t.save(),t.strokeStyle="white",t.lineWidth=.5,t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(i.x,i.y),t.stroke(),t.restore()}i.r(s);class h{constructor(t,s,i,e,h,a,r,o){this.x=s,this.y=i,this.mass=t||1,this.radius=e||50,this.angle=h||0,this.speedX=a||0,this.speedY=r||0,this.rotationSpeed=o||0}update(t,s){this.x+=this.speedX*s,this.y+=this.speedY*s,this.angle+=this.rotationSpeed*s,this.angle%=2*Math.PI,this.x-this.radius>t.canvas.width&&(this.x=-this.radius),this.x+this.radius<0&&(this.x=t.canvas.width+this.radius),this.y-this.radius>t.canvas.height&&(this.y=-this.radius),this.y+this.radius<0&&(this.y=t.canvas.height+this.radius)}push(t,s,i){this.speedX+=i*Math.cos(t)*s/this.mass,this.speedY+=i*Math.sin(t)*s/this.mass}twist(t,s){this.rotationSpeed+=s*t/this.mass}speed(){return Math.sqrt(this.speedX**2+this.speedY**2)}movementAngle(){return Math.atan2(this.speedY,this.speedX)}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.lineTo(0,0),t.strokeStyle="white",t.stroke(),t.restore()}}class a extends h{constructor(t,s,i,e,h,a,r){super(t,i,e,Math.sqrt(t/.001/Math.PI),0,h,a,r),this.lifetime=s,this.life=1}move(t,s){this.life-=s/this.lifetime,this.update(t,s)}draw(t,s){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),function(t,s,i){t.save(),t.fillStyle=`rgb(100%, 100%, ${100*i}%`,t.beginPath(),t.arc(0,0,s,0,2*Math.PI),t.fill(),t.restore()}(t,this.radius,this.life),t.restore()}}class r extends h{constructor(t,s,i,e){super(10,t,s,15,1.5*Math.PI),this.thrusterPower=i,this.steeringPower=i/20,this.rightThruster=!1,this.leftThruster=!1,this.thrusterOn=!1,this.retroOn=!1,this.weaponPower=e||200,this.loaded=!1,this.weaponReloadTime=.25,this.timeUntilReload=this.weaponReloadTime,this.compromised=!1,this.maxHealth=2,this.health=this.maxHealth}move(t,s){this.push(this.angle,(this.thrusterOn-this.retroOn)*this.thrusterPower,s),this.twist((this.rightThruster-this.leftThruster)*this.steeringPower,s),this.loaded=0===this.timeUntilReload,this.loaded||(this.timeUntilReload-=Math.min(s,this.timeUntilReload)),this.compromised&&(this.health-=Math.min(s,this.health)),this.update(t,s)}draw(t,s){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),s&&this.compromised&&(t.save(),t.fillStyle="red",t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.fill(),t.restore()),function(t,s,i={}){t.save();const e=i.curve1||.25,h=i.curve2||.75;i.guide&&(t.strokeStyle="white",t.fillStyle="rgba(0, 0, 0, 0.25)",t.lineWidth=.5,t.beginPath(),t.arc(0,0,s,0,2*Math.PI),t.stroke(),t.fill()),t.lineWidth=i.lineWidth||2,t.strokeStyle=i.stroke||"white",t.fillStyle=i.fill||"black";const a=(i.angle||.5*Math.PI)/2;t.beginPath(),t.moveTo(s,0),t.quadraticCurveTo(Math.cos(a)*s*h,Math.sin(a)*s*h,Math.cos(Math.PI-a)*s,Math.sin(Math.PI-a)*s),t.quadraticCurveTo(-s*e,0,Math.cos(Math.PI+a)*s,Math.sin(Math.PI+a)*s),t.quadraticCurveTo(Math.cos(-a)*s*h,Math.sin(-a)*s*h,s,0),t.closePath(),t.fill(),t.stroke(),i.guide&&(t.strokeStyle="white",t.fillStyle="white",t.lineWidth=.5,t.beginPath(),t.moveTo(Math.cos(-a)*s,Math.sin(-a)*s),t.lineTo(0,0),t.lineTo(Math.cos(a)*s,Math.sin(a)*s),t.moveTo(-s,0),t.lineTo(0,0),t.stroke(),t.beginPath(),t.arc(Math.cos(a)*s*h,Math.sin(a)*s*h,s/40,0,2*Math.PI),t.fill(),t.beginPath(),t.arc(Math.cos(-a)*s*h,Math.sin(-a)*s*h,s/40,0,2*Math.PI),t.fill(),t.beginPath(),t.arc(s*h-s,0,s/50,0,2*Math.PI),t.fill()),i.thruster&&(t.save(),t.strokeStyle="yellow",t.fillStyle="red",t.lineWidth=3,t.beginPath(),t.moveTo(Math.cos(Math.PI+.8*a)*s/2,Math.sin(Math.PI+.8*a)*s/2),t.quadraticCurveTo(2*-s,0,Math.cos(Math.PI-.8*a)*s/2,Math.sin(Math.PI-.8*a)*s/2),t.fill(),t.stroke(),t.restore()),t.restore()}(t,this.radius,{guide:s,thruster:this.thrusterOn}),t.restore()}projectile(t){const s=new a(.025,3,this.x+Math.cos(this.angle)*this.radius,this.y+Math.sin(this.angle)*this.radius,this.speedX,this.speedY,this.rotationSpeed);return s.push(this.angle,this.weaponPower,t),this.push(this.angle+Math.PI,this.weaponPower,t),this.timeUntilReload=this.weaponReloadTime,s}}class o extends h{constructor(t,s,i,e,h,a){super(t,s,i,Math.sqrt(t/1/Math.PI),e,h,a),this.circumference=2*Math.PI*this.radius,this.segments=Math.ceil(this.circumference/15),this.segments=Math.min(25,Math.max(5,this.segments)),this.noise=.2,this.shape=[];for(let t=0;t<this.segments;t++)this.shape.push(2*(Math.random()-.5))}child(t){return new o(t,this.x,this.y,this.speedX,this.speedY,this.rotationSpeed)}draw(t,s){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),function(t,s,i,e={}){t.strokeStyle=e.stroke||"white",t.fillStyle=e.fill||"black",t.save(),t.beginPath();for(let h=0;h<i.length;h++)t.rotate(2*Math.PI/i.length),t.lineTo(s+s*e.noise*i[h],0);t.closePath(),t.fill(),t.stroke(),e.guide&&(t.lineWidth=.5,t.beginPath(),t.arc(0,0,s,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=.2,t.arc(0,0,s+s*e.noise,0,2*Math.PI),t.stroke(),t.beginPath(),t.arc(0,0,s-s*e.noise,0,2*Math.PI),t.stroke()),t.restore()}(t,this.radius,this.shape,{guide:s,noise:this.noise}),t.restore()}}class n{constructor(t,s,i,e,h){this.label=`${t}: `,this.x=s,this.y=i,this.width=e,this.height=h}draw(t,s,i){t.save(),t.strokeStyle="white",t.fillStyle="white",t.font=`${this.height}pt Arial`;const e=t.measureText(this.label).width;t.fillText(this.label,this.x,this.y+this.height-1),t.beginPath(),t.rect(e+this.x,this.y,this.width,this.height),t.stroke(),t.beginPath(),t.rect(e+this.x,this.y,this.width*(s/i),this.height),t.fill(),t.restore()}}class l{constructor(t,s,i,e={}){this.label=`${t}: `,this.x=s,this.y=i,this.digits=e.digits||0,this.pt=e.pt||10,this.align=e.align||"end"}draw(t,s){t.save(),t.fillStyle="white",t.font=`${this.pt}pt Arial`,t.textAlign=this.align,t.fillText(this.label+s.toFixed(this.digits),this.x,this.y+this.pt-1),t.restore()}}class d{constructor(t,s,i={}){this.x=t,this.y=s,this.mainPt=i.mainPt||28,this.subPt=i.subPt||18,this.fill=i.fill||"white",this.textAlign=i.align||"center"}draw(t,s,i){t.save(),t.fillStyle=this.fill,t.textAlign=this.textAlign,t.font=`${this.mainPt}pt Arial`,t.fillText(s,this.x,this.y),t.font=`${this.subPt}pt Arial`,t.fillText(i,this.x,this.y+this.mainPt),t.restore()}}new class{constructor(t){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.canvas.focus(),this.guide=!1,this.shipMass=10,this.shipRadius=15,this.asteroidMass=6e3,this.asteroidPush=2e6,this.massDestroyed=500,this.ship=new r(this.canvas.width/2,this.canvas.height/2,1e3,200),this.projectiles=[],this.asteroids=[],this.asteroids.push(this.movingAsteroid()),this.canvas.addEventListener("keydown",t=>{this.keyDown(t,!0)},!0),this.canvas.addEventListener("keyup",t=>{this.keyUp(t,!0)},!0),this.canvas.addEventListener("mouseover",()=>{this.canvas.focus()},!0),this.healthIndicator=new n("health",5,5,100,10),this.scoreIndicator=new l("score",this.canvas.width-10,5),this.levelIndicator=new l("level",this.canvas.width/2,5,{align:"center"}),this.fpsIndicator=new l("fps",this.canvas.width-10,this.canvas.height-15,{digits:2}),this.message=new d(this.canvas.width/2,.4*this.canvas.height),window.requestAnimationFrame(this.frame.bind(this)),this.resetGame()}levelUp(){this.level+=1;for(let t=0;t<this.level;t++)this.asteroids.push(this.movingAsteroid())}resetGame(){this.score=0,this.level=0,this.gameOver=!1,this.ship=new r(this.canvas.width/2,this.canvas.height/2,1e3,200),this.projectiles=[],this.asteroids=[],this.levelUp()}collision(t,s){return this.distanceBetween(t,s)<t.radius+s.radius}distanceBetween(t,s){return Math.sqrt((t.x-s.x)**2+(t.y-s.y)**2)}movingAsteroid(t){const s=this.newAsteroid();return this.pushAsteroid(s,t),s}newAsteroid(){return new o(this.asteroidMass/3+Math.random()*this.asteroidMass*4/3,this.canvas.width*Math.random(),this.canvas.height*Math.random())}pushAsteroid(t,s){const i=s||.012;t.push(2*Math.PI*Math.random(),this.asteroidPush,i),t.twist((Math.random()-.5)*Math.PI*this.asteroidPush*.02,i)}splitAsteroid(t,s){const i=t.mass-this.massDestroyed;this.score+=this.massDestroyed;const e=.25+.5*Math.random();[t.child(i*e),t.child(i*(1-e))].forEach(t=>{t.mass<this.massDestroyed?this.score+=t.mass:(this.pushAsteroid(t,s),this.asteroids.push(t))},this)}keyDown(t){this.keyHandler(t,!0)}keyUp(t){this.keyHandler(t,!1)}keyHandler(t,s){let i=!1;switch(t.keyCode){case 87:case 38:this.ship.thrusterOn=s;break;case 65:case 37:this.ship.leftThruster=s;break;case 68:case 39:this.ship.rightThruster=s;break;case 83:case 40:this.ship.retroOn=s;break;case 32:this.gameOver?this.resetGame():this.ship.fire=s;break;case 71:s&&(this.guide=!this.guide);break;default:i=!0}i||t.preventDefault()}frame(t){this.previous||(this.previous=t);const s=t-this.previous;this.fps=1e3/s,this.update(s/1e3),this.draw(),this.previous=t,window.requestAnimationFrame(this.frame.bind(this))}update(t){0===this.asteroids.length&&this.levelUp(),this.ship.compromised=!1,this.asteroids.forEach(s=>{s.update(this.ctx,t),this.collision(s,this.ship)&&(this.ship.compromised=!0)},this),this.ship.health<=0?this.gameOver=!0:(this.ship.move(this.ctx,t),this.projectiles.forEach((s,i,e)=>{s.move(this.ctx,t),s.life<=0?e.splice(i,1):this.asteroids.forEach((h,a)=>{this.collision(h,s)&&(e.splice(i,1),this.asteroids.splice(a,1),this.splitAsteroid(h,t))},this)},this),this.ship.fire&&this.ship.loaded&&this.projectiles.push(this.ship.projectile(t)))}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.guide&&(function(t,s=10,i=5*s,e="#0f0",h="#090"){t.save(),t.strokeStyle=e,t.fillStyle=h;const[a,r]=[t.canvas.width,t.canvas.height];for(let e=0;e<a||e<r;e+=s)t.beginPath(),t.moveTo(e,0),t.lineTo(e,r),t.moveTo(0,e),t.lineTo(a,e),t.lineWidth=e%i==0?.5:.25,t.stroke(),e%i==0&&t.fillText(e,e,10),e%i==0&&t.fillText(e,0,e+10);t.restore()}(this.ctx),this.asteroids.forEach(t=>{e(this.ctx,t,this.ship),this.projectiles.forEach(s=>{e(this.ctx,s,t)},this)},this),this.fpsIndicator.draw(this.ctx,this.fps)),this.asteroids.forEach(t=>{t.draw(this.ctx,this.guide)},this),this.scoreIndicator.draw(this.ctx,this.score),this.gameOver?this.message.draw(this.ctx,"GAME OVER","Press space to play again"):(this.ship.draw(this.ctx,this.guide),this.projectiles.forEach(t=>t.draw(this.ctx),this),this.healthIndicator.draw(this.ctx,this.ship.health,this.ship.maxHealth),this.levelIndicator.draw(this.ctx,this.level))}}("asteroids")}]);